<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa" />
  
  <!-- Title -->
  <text x="400" y="30" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold">GraphQL Subscriptions Architecture</text>
  
  <!-- Client Section -->
  <rect x="50" y="70" width="200" height="460" rx="10" ry="10" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" />
  <text x="150" y="95" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Client</text>
  
  <!-- Client Components -->
  <rect x="70" y="110" width="160" height="60" rx="5" ry="5" fill="#bbdefb" stroke="#1e88e5" stroke-width="1" />
  <text x="150" y="135" font-family="Arial" font-size="14" text-anchor="middle">Apollo Client</text>
  <text x="150" y="155" font-family="Arial" font-size="12" text-anchor="middle">GraphQL Operations</text>
  
  <rect x="70" y="190" width="160" height="80" rx="5" ry="5" fill="#bbdefb" stroke="#1e88e5" stroke-width="1" />
  <text x="150" y="215" font-family="Arial" font-size="14" text-anchor="middle">Subscription Links</text>
  <text x="150" y="235" font-family="Arial" font-size="12" text-anchor="middle">HTTP Link</text>
  <text x="150" y="255" font-family="Arial" font-size="12" text-anchor="middle">WebSocket Link</text>
  
  <rect x="70" y="290" width="160" height="60" rx="5" ry="5" fill="#bbdefb" stroke="#1e88e5" stroke-width="1" />
  <text x="150" y="315" font-family="Arial" font-size="14" text-anchor="middle">UI Components</text>
  <text x="150" y="335" font-family="Arial" font-size="12" text-anchor="middle">useSubscription()</text>
  
  <rect x="70" y="370" width="160" height="60" rx="5" ry="5" fill="#bbdefb" stroke="#1e88e5" stroke-width="1" />
  <text x="150" y="395" font-family="Arial" font-size="14" text-anchor="middle">Auth Context</text>
  <text x="150" y="415" font-family="Arial" font-size="12" text-anchor="middle">JWT Management</text>
  
  <rect x="70" y="450" width="160" height="60" rx="5" ry="5" fill="#bbdefb" stroke="#1e88e5" stroke-width="1" />
  <text x="150" y="475" font-family="Arial" font-size="14" text-anchor="middle">Offline Support</text>
  <text x="150" y="495" font-family="Arial" font-size="12" text-anchor="middle">Cache Persistence</text>
  
  <!-- Server Section -->
  <rect x="550" y="70" width="200" height="460" rx="10" ry="10" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" />
  <text x="650" y="95" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Server</text>
  
  <!-- Server Components -->
  <rect x="570" y="110" width="160" height="60" rx="5" ry="5" fill="#c8e6c9" stroke="#43a047" stroke-width="1" />
  <text x="650" y="135" font-family="Arial" font-size="14" text-anchor="middle">GraphQL Yoga</text>
  <text x="650" y="155" font-family="Arial" font-size="12" text-anchor="middle">Schema &amp; Resolvers</text>
  
  <rect x="570" y="190" width="160" height="60" rx="5" ry="5" fill="#c8e6c9" stroke="#43a047" stroke-width="1" />
  <text x="650" y="215" font-family="Arial" font-size="14" text-anchor="middle">WebSocket Server</text>
  <text x="650" y="235" font-family="Arial" font-size="12" text-anchor="middle">Subscription Transport</text>
  
  <rect x="570" y="270" width="160" height="60" rx="5" ry="5" fill="#c8e6c9" stroke="#43a047" stroke-width="1" />
  <text x="650" y="295" font-family="Arial" font-size="14" text-anchor="middle">PubSub System</text>
  <text x="650" y="315" font-family="Arial" font-size="12" text-anchor="middle">Event Distribution</text>
  
  <rect x="570" y="350" width="160" height="60" rx="5" ry="5" fill="#c8e6c9" stroke="#43a047" stroke-width="1" />
  <text x="650" y="375" font-family="Arial" font-size="14" text-anchor="middle">Authentication</text>
  <text x="650" y="395" font-family="Arial" font-size="12" text-anchor="middle">JWT Verification</text>
  
  <rect x="570" y="430" width="160" height="80" rx="5" ry="5" fill="#c8e6c9" stroke="#43a047" stroke-width="1" />
  <text x="650" y="455" font-family="Arial" font-size="14" text-anchor="middle">Data Services</text>
  <text x="650" y="475" font-family="Arial" font-size="12" text-anchor="middle">Database Access</text>
  <text x="650" y="495" font-family="Arial" font-size="12" text-anchor="middle">Business Logic</text>
  
  <!-- Middle Section - Communication -->
  <rect x="300" y="70" width="200" height="460" rx="10" ry="10" fill="#fff3e0" stroke="#ff9800" stroke-width="2" />
  <text x="400" y="95" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">GraphQL Operations</text>
  
  <!-- Operation Types -->
  <rect x="320" y="130" width="160" height="60" rx="5" ry="5" fill="#ffe0b2" stroke="#fb8c00" stroke-width="1" />
  <text x="400" y="155" font-family="Arial" font-size="14" text-anchor="middle">Queries</text>
  <text x="400" y="175" font-family="Arial" font-size="12" text-anchor="middle">Data Fetching</text>
  
  <rect x="320" y="210" width="160" height="60" rx="5" ry="5" fill="#ffe0b2" stroke="#fb8c00" stroke-width="1" />
  <text x="400" y="235" font-family="Arial" font-size="14" text-anchor="middle">Mutations</text>
  <text x="400" y="255" font-family="Arial" font-size="12" text-anchor="middle">Data Modification</text>
  
  <rect x="320" y="290" width="160" height="140" rx="5" ry="5" fill="#ffe0b2" stroke="#fb8c00" stroke-width="1" />
  <text x="400" y="315" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Subscriptions</text>
  <text x="400" y="335" font-family="Arial" font-size="12" text-anchor="middle">{</text>
  <text x="400" y="355" font-family="Arial" font-size="12" text-anchor="middle">  hugReceived {</text>
  <text x="400" y="375" font-family="Arial" font-size="12" text-anchor="middle">    id</text>
  <text x="400" y="395" font-family="Arial" font-size="12" text-anchor="middle">    sender { ... }</text>
  <text x="400" y="415" font-family="Arial" font-size="12" text-anchor="middle">  }</text>
  <text x="400" y="435" font-family="Arial" font-size="12" text-anchor="middle">}</text>
  
  <!-- Connection Lines -->
  <!-- HTTP for Queries/Mutations -->
  <line x1="230" y1="140" x2="320" y2="140" stroke="#1e88e5" stroke-width="2" />
  <text x="275" y="130" font-family="Arial" font-size="10" text-anchor="middle">HTTP</text>
  
  <line x1="230" y1="230" x2="320" y2="230" stroke="#1e88e5" stroke-width="2" />
  <text x="275" y="220" font-family="Arial" font-size="10" text-anchor="middle">HTTP</text>
  
  <!-- WebSocket for Subscriptions -->
  <line x1="230" y1="350" x2="320" y2="350" stroke="#fb8c00" stroke-width="2" stroke-dasharray="5,5" />
  <text x="275" y="340" font-family="Arial" font-size="10" text-anchor="middle">WebSocket</text>
  
  <!-- Server-side connections -->
  <line x1="480" y1="140" x2="570" y2="140" stroke="#43a047" stroke-width="2" />
  <line x1="480" y1="230" x2="570" y2="230" stroke="#43a047" stroke-width="2" />
  <line x1="480" y1="350" x2="570" y2="350" stroke="#43a047" stroke-width="2" stroke-dasharray="5,5" />
  
  <!-- PubSub Flow -->
  <path d="M650,330 C720,330 720,450 650,450" stroke="#43a047" stroke-width="2" fill="none" stroke-dasharray="5,5" />
  <polygon points="645,450 655,445 655,455" fill="#43a047" />
  <text x="710" y="380" font-family="Arial" font-size="10" text-anchor="middle" transform="rotate(90, 710, 380)">Publish Events</text>
  
  <!-- Legend -->
  <rect x="50" y="550" width="700" height="30" rx="5" ry="5" fill="#f8f9fa" stroke="#757575" stroke-width="1" />
  <line x1="80" y1="565" x2="110" y2="565" stroke="#1e88e5" stroke-width="2" />
  <text x="140" y="569" font-family="Arial" font-size="12" text-anchor="start">HTTP Communication</text>
  
  <line x1="260" y1="565" x2="290" y2="565" stroke="#fb8c00" stroke-width="2" stroke-dasharray="5,5" />
  <text x="320" y="569" font-family="Arial" font-size="12" text-anchor="start">WebSocket Communication</text>
  
  <line x1="510" y1="565" x2="540" y2="565" stroke="#43a047" stroke-width="2" stroke-dasharray="5,5" />
  <text x="570" y="569" font-family="Arial" font-size="12" text-anchor="start">Server Event Flow</text>
</svg>